<html><head>
<META http-equiv="Content-Type" content="text/html; charset=windows-1252">
<style>
/* Default heading font (outside of tables) */
body { font-family: sans-serif; font-size: 11pt; }

td { vertical-align: top; padding-left: 4px; padding-right: 4px; }

/* File Difference Report styles - Color */
table.fc { border-top: 1px solid Black; border-left: 1px solid Black; width: 100%; font-family: monospace; font-size: 10pt; }

tr.secBegin td { border-left: none; border-top: none; border-right: 1px solid Black; }
tr.secMiddle td { border-left: none; border-top: none; border-right: 1px solid Black; }
tr.secEnd td { border-left: none; border-top: none; border-bottom: 1px solid Black; border-right: 1px solid Black; }
tr.secAll td { border-left: none; border-top: none; border-bottom: 1px solid Black; border-right: 1px solid Black; }
tr.secSubEnd td { border-left: none; border-top: none; border-bottom: 1px solid Gray; border-right: 1px solid Black; }
tr.secSubAll td { border-left: none; border-top: none; border-bottom: 1px solid Gray; border-right: 1px solid Black; }
tr.secGap td { font-size: 4px; border-left: none; border-top: none; border-bottom: 1px solid Black; border-right: 1px solid Black; }

td.LineNum { text-align: right; }
td.LineRange { font-family: sans-serif; }
td.SubLineRange { font-family: sans-serif; border-bottom: none; }

td.AlignLeft { text-align: left; white-space: nowrap; }
td.AlignRight { text-align: right; white-space: nowrap; }
td.AlignCenter { text-align: center; white-space: nowrap; }
td.Caption { text-align: left; background-color: #E7E7E7; padding-top: 8px; }

td.Normal { white-space: nowrap; }
td.HasSimilar { background-color: #F0F0FF; white-space: nowrap; }
td.HasMismatch { background-color: #FFF0F0; white-space: nowrap; }
td.HasOrphan { background-color: #FFF0F0; white-space: nowrap; }
td.Added { background-color: #FFF0F0; white-space: nowrap; }
td.Deleted { background-color: #FFF0F0; text-decoration: line-through; white-space: nowrap; }
td.UAdded { background-color: #F0F0FF; white-space: nowrap; }
td.UDeleted { background-color: #F0F0FF; text-decoration: line-through; white-space: nowrap; }

.ttSigDiff { color: #FF0000; }
.ttInsigDiff { color: #0000FF; }
.ttAdded { color: #FF0000; }
.ttDeleted { text-decoration: line-through; }

/* Directory Comparison Report styles - Color */
table.dc { border-top: 1px solid Black; border-left: 1px solid Black; width: 100%; font-family: sans-serif; font-size: 10pt; }

table.dc tr.secBegin td { border-bottom: 1px solid Silver; }
table.dc tr.secMiddle td { border-bottom: 1px solid Silver; }

.ttNewer { color: #FF0000; }
.ttOlder { color: #808080; }
.ttOrphan { color: #0000FF; }
.ttGhosted { color: #008080; }
</style>
</head><body>
FILE COMPARISON<br />
Produced: 9/2/2009 9:35:13 AM<br />
&nbsp; &nbsp;
<br />
Mode:&nbsp; Differences with Context &nbsp;
<br />
Left base folder: Z:\PROJECTS\libusb-win32-src-0.1.12.2\src\driver &nbsp;
<br />
Right base folder: Z:\PROJECTS\LibWinUsb\libusb-win32-src-2.1.12.2m\src\driver &nbsp;
<br />
&nbsp; &nbsp;
<br />
File: driver_api.h &nbsp;
<br />
<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">96</td>
<td class="Normal">#define LIBUSB_IOCTL_CLAIM_INTERFACE CTL_CODE(FILE_DEVICE_UNKNOWN,\</td>
<td class="AlignCenter">=</td>
<td class="LineNum">96</td>
<td class="Normal">#define LIBUSB_IOCTL_CLAIM_INTERFACE CTL_CODE(FILE_DEVICE_UNKNOWN,\</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">97</td>
<td class="Normal">0x815, METHOD_BUFFERED, FILE_ANY_ACCESS)</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">97</td>
<td class="Normal">0x815, METHOD_BUFFERED, FILE_ANY_ACCESS)</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">98</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">98</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">99</td>
<td class="Normal">#define LIBUSB_IOCTL_RELEASE_INTERFACE CTL_CODE(FILE_DEVICE_UNKNOWN,\</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">99</td>
<td class="Normal">#define LIBUSB_IOCTL_RELEASE_INTERFACE CTL_CODE(FILE_DEVICE_UNKNOWN,\</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">100</td>
<td class="Normal">0x816, METHOD_BUFFERED, FILE_ANY_ACCESS)</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">100</td>
<td class="Normal">0x816, METHOD_BUFFERED, FILE_ANY_ACCESS)</td>
</tr>
<tr class="secEnd">
<td class="LineNum">101</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">101</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">102</td>
<td class="HasOrphan"><span class="ttSigDiff">#define</span> <span class="ttSigDiff">LIBUSB_IOCTL_GET_REG_PROPERTY</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">CTL_CODE(FILE_DEVICE_UNKNOWN,0x900,</span> <span class="ttSigDiff">METHOD_BUFFERED,</span> <span class="ttSigDiff">FILE_ANY_ACCESS)</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">103</td>
<td class="HasOrphan"><span class="ttSigDiff">#define</span> <span class="ttSigDiff">LIBUSB_IOCTL_GET_CUSTOM_REG_PROPERTY</span>&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">CTL_CODE(FILE_DEVICE_UNKNOWN,0x901,</span> <span class="ttSigDiff">METHOD_BUFFERED,</span> <span class="ttSigDiff">FILE_ANY_ACCESS)</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">104</td>
<td class="HasOrphan"><span class="ttSigDiff">#define</span> <span class="ttSigDiff">LIBUSB_IOCTL_SET_CUSTOM_REG_PROPERTY</span>&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">CTL_CODE(FILE_DEVICE_UNKNOWN,0x902,</span> <span class="ttSigDiff">METHOD_BUFFERED,</span> <span class="ttSigDiff">FILE_ANY_ACCESS)</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">105</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">106</td>
<td class="HasOrphan"><span class="ttSigDiff">#define</span> <span class="ttSigDiff">LIBUSB_IOCTL_CONTROL_TRANSFER</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">CTL_CODE(FILE_DEVICE_UNKNOWN,0x903,</span> <span class="ttSigDiff">METHOD_BUFFERED,</span> <span class="ttSigDiff">FILE_ANY_ACCESS)</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">107</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">102</td>
<td class="Normal">#include &lt;pshpack1.h&gt; </td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">108</td>
<td class="Normal">#include &lt;pshpack1.h&gt; </td>
</tr>
<tr class="secMiddle">
<td class="LineNum">103</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">109</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">104</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">110</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">105</td>
<td class="Normal">typedef struct {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">111</td>
<td class="Normal">typedef struct {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">106</td>
<td class="Normal">&nbsp; unsigned int timeout;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">112</td>
<td class="Normal">&nbsp; unsigned int timeout;</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">153</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; struct</td>
<td class="AlignCenter">=</td>
<td class="LineNum">159</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; struct</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">154</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">160</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">155</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unsigned int major;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">161</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; unsigned int major;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">156</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unsigned int minor;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">162</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; unsigned int minor;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">157</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unsigned int micro;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">163</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; unsigned int micro;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">158</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unsigned int nano;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">164</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; unsigned int nano;</td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">165</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">BcdLibUsbDotNetKernelMod;</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">159</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } version;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">166</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } version;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">167</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">struct</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">168</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">169</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">propertyId;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">170</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span> <span class="ttSigDiff">deviceProperty;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">171</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">struct</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">172</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">173</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">keyType;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">174</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">nameOffset;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">175</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">valueOffset;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">176</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">valueLength;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">177</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span> <span class="ttSigDiff">deviceKeySet;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">178</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">struct</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">179</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">180</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">char</span> <span class="ttSigDiff">requestType;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">181</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">char</span> <span class="ttSigDiff">request;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">182</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">short</span> <span class="ttSigDiff">value;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">183</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">short</span> <span class="ttSigDiff">index;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">184</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">short</span> <span class="ttSigDiff">length;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">185</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span> <span class="ttSigDiff">control;</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">160</td>
<td class="Normal">&nbsp; };</td>
<td class="AlignCenter">=</td>
<td class="LineNum">186</td>
<td class="Normal">&nbsp; };</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">161</td>
<td class="Normal">} libusb_request;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">187</td>
<td class="Normal">} libusb_request;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">162</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; </td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">188</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; </td>
</tr>
<tr class="secMiddle">
<td class="LineNum">163</td>
<td class="Normal">#include &lt;poppack.h&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">189</td>
<td class="Normal">#include &lt;poppack.h&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">164</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">190</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">165</td>
<td class="Normal">#endif</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">191</td>
<td class="Normal">#endif</td>
</tr>
</table>
&nbsp; &nbsp;
<br />
File: driver_registry.c &nbsp;
<br />
<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">129</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">129</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">130</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">130</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">131</td>
<td class="Normal">&nbsp; return reg_get_property(physical_device_object, DevicePropertyHardwareID, </td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">131</td>
<td class="Normal">&nbsp; return reg_get_property(physical_device_object, DevicePropertyHardwareID, </td>
</tr>
<tr class="secMiddle">
<td class="LineNum">132</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; data, size);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">132</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; data, size);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">133</td>
<td class="Normal">}</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">133</td>
<td class="Normal">}</td>
</tr>
<tr class="secEnd">
<td class="LineNum">134</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">134</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">135</td>
<td class="HasOrphan"><span class="ttSigDiff">bool_t</span> <span class="ttSigDiff">reg_get_property_ex(DEVICE_OBJECT</span> <span class="ttSigDiff">*physical_device_object,</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">property,</span> <span class="ttSigDiff">char</span> <span class="ttSigDiff">*data,</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">size,</span> <span class="ttSigDiff">int*</span> <span class="ttSigDiff">pReturnBytesCount)</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">136</td>
<td class="HasOrphan"><span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">137</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">ULONG</span> <span class="ttSigDiff">ret;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">138</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">ULONG</span> <span class="ttSigDiff">i;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">139</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if</span> <span class="ttSigDiff">(!physical_device_object</span> <span class="ttSigDiff">||</span> <span class="ttSigDiff">!data</span> <span class="ttSigDiff">||</span> <span class="ttSigDiff">!size</span> <span class="ttSigDiff">||</span> <span class="ttSigDiff">!pReturnBytesCount)</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">140</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">141</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">return</span> <span class="ttSigDiff">FALSE;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">142</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">143</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">*pReturnBytesCount=0;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">144</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">memset(data,</span> <span class="ttSigDiff">0,</span> <span class="ttSigDiff">size);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">145</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if</span> <span class="ttSigDiff">(NT_SUCCESS(IoGetDeviceProperty(physical_device_object,</span> <span class="ttSigDiff">property,</span> <span class="ttSigDiff">size</span> <span class="ttSigDiff">-</span> <span class="ttSigDiff">2,data,</span> <span class="ttSigDiff">&amp;ret)))</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">146</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">147</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">*pReturnBytesCount=ret;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">148</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">return</span> <span class="ttSigDiff">TRUE;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">149</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">150</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">return</span> <span class="ttSigDiff">FALSE;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">151</td>
<td class="HasOrphan"><span class="ttSigDiff">}</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">152</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">153</td>
<td class="HasOrphan"><span class="ttSigDiff">NTSTATUS</span> <span class="ttSigDiff">reg_get_custom_property(libusb_device_t</span> <span class="ttSigDiff">*dev,</span> <span class="ttSigDiff">char</span> <span class="ttSigDiff">*pBuffer,</span> <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">bufferSize,</span> <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">nameOffset,</span> <span class="ttSigDiff">int*</span> <span class="ttSigDiff">pReturnBytesCount)</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">154</td>
<td class="HasOrphan"><span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">155</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">HANDLE</span> <span class="ttSigDiff">key</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">NULL;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">156</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">NTSTATUS</span> <span class="ttSigDiff">status;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">157</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">UNICODE_STRING</span> <span class="ttSigDiff">name;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">158</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">KEY_VALUE_FULL_INFORMATION</span> <span class="ttSigDiff">*info;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">159</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">ULONG</span> <span class="ttSigDiff">length;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">160</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if</span> <span class="ttSigDiff">(!dev-&gt;physical_device_object)</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">161</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">162</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">return</span> <span class="ttSigDiff">STATUS_INVALID_PARAMETER;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">163</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">164</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">status</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">IoOpenDeviceRegistryKey(dev-&gt;physical_device_object,</span> <span class="ttSigDiff">PLUGPLAY_REGKEY_DEVICE,</span> <span class="ttSigDiff">STANDARD_RIGHTS_ALL,</span> <span class="ttSigDiff">&amp;key);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">165</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if</span> <span class="ttSigDiff">(NT_SUCCESS(status))</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">166</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">167</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">RtlInitUnicodeString(&amp;name,</span> <span class="ttSigDiff">(WCHAR*)(&amp;pBuffer[nameOffset]));</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">168</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">length</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">sizeof(KEY_VALUE_FULL_INFORMATION)</span> <span class="ttSigDiff">+</span> <span class="ttSigDiff">name.MaximumLength</span> <span class="ttSigDiff">+</span> <span class="ttSigDiff">bufferSize;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">169</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">info</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">ExAllocatePool(NonPagedPool,</span> <span class="ttSigDiff">length);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">170</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if</span> <span class="ttSigDiff">(info)</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">171</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">172</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">memset(info,</span> <span class="ttSigDiff">0,</span> <span class="ttSigDiff">length);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">173</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">status</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">ZwQueryValueKey(key,</span> <span class="ttSigDiff">&amp;name,</span> <span class="ttSigDiff">KeyValueFullInformation,</span> <span class="ttSigDiff">info,</span> <span class="ttSigDiff">length,</span> <span class="ttSigDiff">&amp;length);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">174</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if</span> <span class="ttSigDiff">(NT_SUCCESS(status))</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">175</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">176</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">bufferSize</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">(info-&gt;DataLength</span> <span class="ttSigDiff">&gt;</span> <span class="ttSigDiff">bufferSize)</span> <span class="ttSigDiff">?</span> <span class="ttSigDiff">bufferSize</span> <span class="ttSigDiff">:</span> <span class="ttSigDiff">info-&gt;DataLength;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">177</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">memcpy(pBuffer,</span> <span class="ttSigDiff">(((char</span> <span class="ttSigDiff">*)info)</span> <span class="ttSigDiff">+</span> <span class="ttSigDiff">info-&gt;DataOffset),bufferSize);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">178</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">*pReturnBytesCount=bufferSize;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">179</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">180</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">ExFreePool(info);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">181</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">182</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">ZwClose(key);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">183</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">184</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">return</span> <span class="ttSigDiff">status;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">185</td>
<td class="HasOrphan"><span class="ttSigDiff">}</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">186</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">187</td>
<td class="HasOrphan"><span class="ttSigDiff">NTSTATUS</span> <span class="ttSigDiff">reg_set_custom_property(libusb_device_t</span> <span class="ttSigDiff">*dev,</span> <span class="ttSigDiff">char*</span> <span class="ttSigDiff">pBuffer,</span> <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">keyType,</span> <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">nameOffset,</span> <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">valueOffset,</span> <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">valueLength)</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">188</td>
<td class="HasOrphan"><span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">189</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">HANDLE</span> <span class="ttSigDiff">key</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">NULL;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">190</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">NTSTATUS</span> <span class="ttSigDiff">status;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">191</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">UNICODE_STRING</span> <span class="ttSigDiff">name;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">192</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">WCHAR*</span> <span class="ttSigDiff">pKeyName</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">NULL;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">193</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">char*</span> <span class="ttSigDiff">pKeyValue;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">194</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if</span> <span class="ttSigDiff">(!dev-&gt;physical_device_object)</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">195</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">196</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">return</span> <span class="ttSigDiff">STATUS_INVALID_PARAMETER;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">197</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">198</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">status</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">IoOpenDeviceRegistryKey(dev-&gt;physical_device_object,</span> <span class="ttSigDiff">PLUGPLAY_REGKEY_DEVICE,</span> <span class="ttSigDiff">STANDARD_RIGHTS_ALL,</span> <span class="ttSigDiff">&amp;key);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">199</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if</span> <span class="ttSigDiff">(NT_SUCCESS(status))</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">200</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">201</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">pKeyName=(WCHAR*)(pBuffer+nameOffset);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">202</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">pKeyValue=(char*)(pBuffer+valueOffset);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">203</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">RtlInitUnicodeString(&amp;name,</span> <span class="ttSigDiff">pKeyName);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">204</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">status</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">ZwSetValueKey(key,</span> <span class="ttSigDiff">&amp;name,</span> <span class="ttSigDiff">0,keyType,</span> <span class="ttSigDiff">pKeyValue,</span> <span class="ttSigDiff">valueLength);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">205</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">ZwClose(key);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">206</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">207</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">return</span> <span class="ttSigDiff">status;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">208</td>
<td class="HasOrphan"><span class="ttSigDiff">}</span></td>
</tr>
</table>
&nbsp; &nbsp;
<br />
File: get_interface.c &nbsp;
<br />
<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">18</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">18</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">19</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">19</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">20</td>
<td class="Normal">#include &quot;libusb_driver.h&quot;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">20</td>
<td class="Normal">#include &quot;libusb_driver.h&quot;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">21</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">21</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">22</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">22</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">23</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">23</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">24</td>
<td class="HasMismatch">NTSTATUS get_interface(libusb_device_t *dev,</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">24</td>
<td class="HasMismatch">NTSTATUS get_interface<span class="ttSigDiff">_original</span>(libusb_device_t *dev,</td>
</tr>
<tr class="secBegin">
<td class="LineNum">25</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int interface, unsigned char *altsetting, </td>
<td class="AlignCenter">=</td>
<td class="LineNum">25</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int interface, unsigned char *altsetting, </td>
</tr>
<tr class="secMiddle">
<td class="LineNum">26</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int *ret, int timeout)</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">26</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int *ret, int timeout)</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">27</td>
<td class="Normal">{</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">27</td>
<td class="Normal">{</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">28</td>
<td class="Normal">&nbsp; NTSTATUS status = STATUS_SUCCESS;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">28</td>
<td class="Normal">&nbsp; NTSTATUS status = STATUS_SUCCESS;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">29</td>
<td class="Normal">&nbsp; URB urb;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">29</td>
<td class="Normal">&nbsp; URB urb;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">30</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">30</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">61</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DEBUG_MESSAGE(&quot;get_interface(): current altsetting is %d&quot;, *altsetting); </td>
<td class="AlignCenter">=</td>
<td class="LineNum">61</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DEBUG_MESSAGE(&quot;get_interface(): current altsetting is %d&quot;, *altsetting); </td>
</tr>
<tr class="secMiddle">
<td class="LineNum">62</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">62</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">63</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">63</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">64</td>
<td class="Normal">&nbsp; return status;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">64</td>
<td class="Normal">&nbsp; return status;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">65</td>
<td class="Normal">}</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">65</td>
<td class="Normal">}</td>
</tr>
<tr class="secEnd">
<td class="LineNum">66</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">66</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">67</td>
<td class="HasOrphan"><span class="ttSigDiff">NTSTATUS</span> <span class="ttSigDiff">get_interface(libusb_device_t</span> <span class="ttSigDiff">*dev,</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">interface,</span> <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">char</span> <span class="ttSigDiff">*altsetting,</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">*ret,</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">timeout)</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">68</td>
<td class="HasOrphan"><span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">69</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">NTSTATUS</span> <span class="ttSigDiff">status</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">STATUS_SUCCESS;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">70</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">URB</span> <span class="ttSigDiff">urb;</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">67</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">71</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">72</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">DEBUG_PRINT_NL();</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">73</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">DEBUG_MESSAGE(&quot;get_interface(): interface %d&quot;,</span> <span class="ttSigDiff">interface);</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">74</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">DEBUG_MESSAGE(&quot;get_interface(): timeout %d&quot;,</span> <span class="ttSigDiff">timeout);</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">75</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">76</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if</span> <span class="ttSigDiff">(!dev-&gt;config.value)</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">77</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">78</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">DEBUG_ERROR(&quot;get_interface(): invalid configuration 0&quot;);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">79</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">return</span> <span class="ttSigDiff">STATUS_INVALID_DEVICE_STATE;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">80</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">81</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">82</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">memset(&amp;urb,</span> <span class="ttSigDiff">0,</span> <span class="ttSigDiff">sizeof(URB));</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">83</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">84</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">urb.UrbHeader.Function</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">URB_FUNCTION_CONTROL_TRANSFER;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">85</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">urb.UrbHeader.Length</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">sizeof(struct</span> <span class="ttSigDiff">_URB_CONTROL_TRANSFER);</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">86</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">87</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">urb.UrbControlTransfer.TransferBufferLength</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">1;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">88</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">urb.UrbControlTransfer.TransferBuffer</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">altsetting;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">89</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">urb.UrbControlTransfer.TransferFlags</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">USBD_DEFAULT_PIPE_TRANSFER</span> <span class="ttSigDiff">|</span> <span class="ttSigDiff">USBD_TRANSFER_DIRECTION_IN</span> <span class="ttSigDiff">|</span> <span class="ttSigDiff">USBD_SHORT_TRANSFER_OK;</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">90</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">91</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">urb.UrbControlTransfer.SetupPacket[0]=(UCHAR)0x80</span> <span class="ttSigDiff">|</span> <span class="ttSigDiff">BMREQUEST_TO_INTERFACE;</span>&nbsp;&nbsp;&nbsp;&nbsp; // RequestType</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">92</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">urb.UrbControlTransfer.SetupPacket[1]=(UCHAR)USB_REQUEST_GET_INTERFACE;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Request</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">93</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">*((USHORT*)&amp;urb.UrbControlTransfer.SetupPacket[2])</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">(USHORT)0;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Value</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">94</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">*((USHORT*)&amp;urb.UrbControlTransfer.SetupPacket[4])</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">(USHORT)interface;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Index</td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">95</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">*((USHORT*)&amp;urb.UrbControlTransfer.SetupPacket[6])</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">(USHORT)1;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Length</td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">96</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">97</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">status</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">call_usbd(dev,</span> <span class="ttSigDiff">&amp;urb,</span> <span class="ttSigDiff">IOCTL_INTERNAL_USB_SUBMIT_URB,</span> <span class="ttSigDiff">timeout);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">98</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if</span> <span class="ttSigDiff">(!NT_SUCCESS(status)</span> <span class="ttSigDiff">||</span> <span class="ttSigDiff">!USBD_SUCCESS(urb.UrbHeader.Status))</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">99</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">return</span>&nbsp; <span class="ttSigDiff">get_interface_original(dev,interface,altsetting,ret,timeout);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">100</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">else</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">101</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">102</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">*ret</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">urb.UrbControlTransfer.TransferBufferLength;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">103</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">DEBUG_MESSAGE(&quot;get_interface(): current altsetting is %d&quot;,</span> <span class="ttSigDiff">*altsetting);</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">104</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">105</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">106</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">return</span> <span class="ttSigDiff">status;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">107</td>
<td class="HasOrphan"><span class="ttSigDiff">}</span></td>
</tr>
</table>
&nbsp; &nbsp;
<br />
File: ioctl.c &nbsp;
<br />
<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">276</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">276</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">277</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">277</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">278</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request-&gt;version.major = VERSION_MAJOR;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">278</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request-&gt;version.major = VERSION_MAJOR;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">279</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request-&gt;version.minor = VERSION_MINOR;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">279</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request-&gt;version.minor = VERSION_MINOR;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">280</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request-&gt;version.micro = VERSION_MICRO;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">280</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request-&gt;version.micro = VERSION_MICRO;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">281</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request-&gt;version.nano&nbsp; = VERSION_NANO;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">281</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request-&gt;version.nano&nbsp; = VERSION_NANO;</td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">282</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">request-&gt;version.BcdLibUsbDotNetKernelMod</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">((2</span> <span class="ttSigDiff">&amp;</span> <span class="ttSigDiff">0xff)</span> <span class="ttSigDiff">&lt;&lt;</span> <span class="ttSigDiff">24)</span> <span class="ttSigDiff">|</span> <span class="ttSigDiff">((0</span> <span class="ttSigDiff">&amp;</span> <span class="ttSigDiff">0xff)</span> <span class="ttSigDiff">&lt;&lt;</span> <span class="ttSigDiff">16)</span> <span class="ttSigDiff">|</span> <span class="ttSigDiff">((3</span> <span class="ttSigDiff">&amp;</span> <span class="ttSigDiff">0xff)</span> <span class="ttSigDiff">&lt;&lt;</span> <span class="ttSigDiff">8)</span> <span class="ttSigDiff">|</span> <span class="ttSigDiff">(15182</span> <span class="ttSigDiff">&amp;</span> <span class="ttSigDiff">0xff);</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">282</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">283</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">283</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret = sizeof(libusb_request);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">284</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret = sizeof(libusb_request);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">284</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">285</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">285</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">286</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">286</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; case LIBUSB_IOCTL_CLAIM_INTERFACE:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">287</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; case LIBUSB_IOCTL_CLAIM_INTERFACE:</td>
</tr>
<tr class="secEnd">
<td class="LineNum">287</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; status = claim_interface(dev, stack_location-&gt;FileObject,</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">288</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; status = claim_interface(dev, stack_location-&gt;FileObject,</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">319</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">320</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">320</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return transfer(dev, irp, USBD_TRANSFER_DIRECTION_OUT,</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">321</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return transfer(dev, irp, USBD_TRANSFER_DIRECTION_OUT,</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">321</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; URB_FUNCTION_ISOCH_TRANSFER, request-&gt;endpoint.endpoint,</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">322</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; URB_FUNCTION_ISOCH_TRANSFER, request-&gt;endpoint.endpoint,</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">322</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request-&gt;endpoint.packet_size, transfer_buffer_mdl, </td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">323</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request-&gt;endpoint.packet_size, transfer_buffer_mdl, </td>
</tr>
<tr class="secMiddle">
<td class="LineNum">323</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; transfer_buffer_length);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">324</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; transfer_buffer_length);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">324</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">325</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">326</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">case</span> <span class="ttSigDiff">LIBUSB_IOCTL_CONTROL_TRANSFER:</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">327</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if</span> <span class="ttSigDiff">(USB_ENDPOINT_DIRECTION_IN(request-&gt;control.requestType))</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">328</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">329</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">status</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">control_transfer(dev,</span> <span class="ttSigDiff">request,output_buffer,</span> <span class="ttSigDiff">output_buffer_length,</span> <span class="ttSigDiff">&amp;ret);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">330</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">331</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">else</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">332</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">333</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">status</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">control_transfer(</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">334</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">dev,</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">335</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">request,</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">336</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">input_buffer_length</span> <span class="ttSigDiff">==</span> <span class="ttSigDiff">sizeof(libusb_request)</span> <span class="ttSigDiff">?</span> <span class="ttSigDiff">NULL</span> <span class="ttSigDiff">:</span> <span class="ttSigDiff">input_buffer</span> <span class="ttSigDiff">+</span> <span class="ttSigDiff">sizeof(libusb_request),</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">337</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">input_buffer_length</span> <span class="ttSigDiff">-</span> <span class="ttSigDiff">sizeof(libusb_request),</span> <span class="ttSigDiff">&amp;ret);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">338</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">339</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">break;</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">340</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">341</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">case</span> <span class="ttSigDiff">LIBUSB_IOCTL_GET_REG_PROPERTY:</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">342</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if</span> <span class="ttSigDiff">(!request</span> <span class="ttSigDiff">||</span> <span class="ttSigDiff">output_buffer_length</span> <span class="ttSigDiff">&lt;</span> <span class="ttSigDiff">sizeof(libusb_request))</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">343</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">344</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">DEBUG_ERROR(&quot;dispatch_ioctl(), LIBUSB_IOCTL_GET_REG_PROPERTY: invalid output buffer&quot;);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">345</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">status</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">STATUS_INVALID_PARAMETER;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">346</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">break;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">347</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">348</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if</span> <span class="ttSigDiff">(!reg_get_property_ex(dev-&gt;physical_device_object,</span> <span class="ttSigDiff">request-&gt;deviceProperty.propertyId,</span> <span class="ttSigDiff">output_buffer,</span> <span class="ttSigDiff">output_buffer_length,</span> <span class="ttSigDiff">&amp;ret))</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">349</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">status</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">STATUS_INVALID_PARAMETER;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">350</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">break;</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">351</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">352</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">case</span> <span class="ttSigDiff">LIBUSB_IOCTL_GET_CUSTOM_REG_PROPERTY:</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">353</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if</span> <span class="ttSigDiff">(!input_buffer</span> <span class="ttSigDiff">||</span> <span class="ttSigDiff">(input_buffer_length</span> <span class="ttSigDiff">&lt;</span> <span class="ttSigDiff">sizeof(libusb_request)))</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">354</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">355</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">DEBUG_ERROR(&quot;dispatch_ioctl(), LIBUSB_IOCTL_GET_CUSTOM_REG_PROPERTY: invalid buffer&quot;);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">356</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">status</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">STATUS_INVALID_PARAMETER;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">357</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">break;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">358</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">359</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">status=reg_get_custom_property(dev,</span> <span class="ttSigDiff">input_buffer,</span> <span class="ttSigDiff">output_buffer_length,</span> <span class="ttSigDiff">request-&gt;deviceKeySet.nameOffset,</span> <span class="ttSigDiff">&amp;ret);</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">360</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">break;</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">361</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">362</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">case</span> <span class="ttSigDiff">LIBUSB_IOCTL_SET_CUSTOM_REG_PROPERTY:</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">363</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if</span> <span class="ttSigDiff">(!input_buffer</span> <span class="ttSigDiff">||</span> <span class="ttSigDiff">(input_buffer_length</span> <span class="ttSigDiff">&lt;</span> <span class="ttSigDiff">sizeof(libusb_request)))</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">364</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">365</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">DEBUG_ERROR(&quot;dispatch_ioctl(), LIBUSB_IOCTL_SET_CUSTOM_REG_PROPERTY: invalid buffer&quot;);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">366</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">status</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">STATUS_INVALID_PARAMETER;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">367</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">break;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">368</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">369</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">status=reg_set_custom_property(dev,</span> <span class="ttSigDiff">input_buffer,</span> <span class="ttSigDiff">request-&gt;deviceKeySet.keyType,</span> <span class="ttSigDiff">request-&gt;deviceKeySet.nameOffset,</span> <span class="ttSigDiff">request-&gt;deviceKeySet.valueOffset,</span> <span class="ttSigDiff">request-&gt;deviceKeySet.valueLength);</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">370</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">break;</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">371</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; </td>
</tr>
<tr class="secMiddle">
<td class="LineNum">325</td>
<td class="Normal">&nbsp;&nbsp;&nbsp default:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">372</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; default:</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">326</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">373</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </td>
</tr>
<tr class="secMiddle">
<td class="LineNum">327</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; status = STATUS_INVALID_PARAMETER;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">374</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; status = STATUS_INVALID_PARAMETER;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">328</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">375</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">329</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">376</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">330</td>
<td class="Normal">&nbsp; status = complete_irp(irp, status, ret);&nbsp; </td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">377</td>
<td class="Normal">&nbsp; status = complete_irp(irp, status, ret);&nbsp; </td>
</tr>
<tr class="secMiddle">
<td class="LineNum">331</td>
<td class="Normal">&nbsp; remove_lock_release(dev);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">378</td>
<td class="Normal">&nbsp; remove_lock_release(dev);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">332</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">379</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">333</td>
<td class="Normal">&nbsp; return status;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">380</td>
<td class="Normal">&nbsp; return status;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">334</td>
<td class="Normal">}</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">381</td>
<td class="Normal">}</td>
</tr>
</table>
&nbsp; &nbsp;
<br />
File: libusb_driver.h &nbsp;
<br />
<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">229</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">229</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">230</td>
<td class="Normal">USB_INTERFACE_DESCRIPTOR *</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">230</td>
<td class="Normal">USB_INTERFACE_DESCRIPTOR *</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">231</td>
<td class="Normal">find_interface_desc(USB_CONFIGURATION_DESCRIPTOR *config_desc, </td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">231</td>
<td class="Normal">find_interface_desc(USB_CONFIGURATION_DESCRIPTOR *config_desc, </td>
</tr>
<tr class="secMiddle">
<td class="LineNum">232</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unsigned int size, int interface_number, int altsetting);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">232</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unsigned int size, int interface_number, int altsetting);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">233</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">233</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">234</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">234</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">235</td>
<td class="HasOrphan"><span class="ttSigDiff">bool_t</span> <span class="ttSigDiff">reg_get_property_ex(DEVICE_OBJECT</span> <span class="ttSigDiff">*physical_device_object,</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">property,</span> <span class="ttSigDiff">char</span> <span class="ttSigDiff">*data,</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">size,</span> <span class="ttSigDiff">int*</span> <span class="ttSigDiff">pReturnBytesCount);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">236</td>
<td class="HasOrphan"><span class="ttSigDiff">NTSTATUS</span> <span class="ttSigDiff">reg_get_custom_property(libusb_device_t</span> <span class="ttSigDiff">*dev,</span> <span class="ttSigDiff">char</span> <span class="ttSigDiff">*pBuffer,</span> <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">bufferSize,</span> <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">nameOffset,</span> <span class="ttSigDiff">int*</span> <span class="ttSigDiff">pReturnBytesCount);</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">237</td>
<td class="HasOrphan"><span class="ttSigDiff">NTSTATUS</span> <span class="ttSigDiff">reg_set_custom_property(libusb_device_t</span> <span class="ttSigDiff">*dev,</span> <span class="ttSigDiff">char*</span> <span class="ttSigDiff">pBuffer,</span> <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">keyType,</span> <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">nameOffset,</span> <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">valueOffset,</span> <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">valueLength);</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">235</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">238</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">239</td>
<td class="HasOrphan"><span class="ttSigDiff">NTSTATUS</span> <span class="ttSigDiff">control_transfer(libusb_device_t</span> <span class="ttSigDiff">*dev,libusb_request</span> <span class="ttSigDiff">*pRequest,</span> <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">char</span> <span class="ttSigDiff">*pTransferBuffer,</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">transferBufferSize,</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">*ret);</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">240</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">236</td>
<td class="Normal">#endif</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">241</td>
<td class="Normal">#endif</td>
</tr>
</table>
&nbsp; &nbsp;
<br />
File: transfer.c &nbsp;
<br />
<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">246</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (*urb)-&gt;UrbBulkOrInterruptTransfer.TransferBufferMDL = buffer;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">246</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (*urb)-&gt;UrbBulkOrInterruptTransfer.TransferBufferMDL = buffer;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">247</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">247</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">248</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">248</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">249</td>
<td class="Normal">&nbsp; return STATUS_SUCCESS;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">249</td>
<td class="Normal">&nbsp; return STATUS_SUCCESS;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">250</td>
<td class="Normal">}</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">250</td>
<td class="Normal">}</td>
</tr>
<tr class="secEnd">
<td class="LineNum">251</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">251</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">252</td>
<td class="HasOrphan"><span class="ttSigDiff">NTSTATUS</span> <span class="ttSigDiff">control_transfer(libusb_device_t</span> <span class="ttSigDiff">*dev,libusb_request</span> <span class="ttSigDiff">*pRequest,</span> <span class="ttSigDiff">unsigned</span> <span class="ttSigDiff">char</span> <span class="ttSigDiff">*pTransferBuffer,</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">transferBufferSize,</span> <span class="ttSigDiff">int</span> <span class="ttSigDiff">*ret)</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">253</td>
<td class="HasOrphan"><span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">254</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">NTSTATUS</span> <span class="ttSigDiff">status</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">STATUS_SUCCESS;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">255</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">URB</span> <span class="ttSigDiff">urb;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">256</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">DEBUG_PRINT_NL();</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">257</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">258</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if</span> <span class="ttSigDiff">(!dev-&gt;config.value)</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">259</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">260</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">DEBUG_ERROR(&quot;control_transfer(): invalid configuration 0&quot;);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">261</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">return</span> <span class="ttSigDiff">STATUS_INVALID_DEVICE_STATE;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">262</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">263</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">DEBUG_MESSAGE(&quot;control_transfer(): size %d&quot;,</span> <span class="ttSigDiff">transferBufferSize);</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">264</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">DEBUG_MESSAGE(&quot;control_transfer(): timeout %d&quot;,</span> <span class="ttSigDiff">pRequest-&gt;timeout);</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">265</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">266</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">memset(&amp;urb,</span> <span class="ttSigDiff">0,</span> <span class="ttSigDiff">sizeof(URB));</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">267</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">268</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">urb.UrbHeader.Function</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">URB_FUNCTION_CONTROL_TRANSFER;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">269</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">urb.UrbHeader.Length</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">sizeof(struct</span> <span class="ttSigDiff">_URB_CONTROL_TRANSFER);</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">270</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">271</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">urb.UrbControlTransfer.TransferBufferLength</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">transferBufferSize;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">272</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">urb.UrbControlTransfer.TransferBuffer</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">pTransferBuffer;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">273</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">urb.UrbControlTransfer.TransferFlags</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">USBD_DEFAULT_PIPE_TRANSFER;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">274</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if</span> <span class="ttSigDiff">(USB_ENDPOINT_DIRECTION_IN(pRequest-&gt;control.requestType))</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">275</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">urb.UrbControlTransfer.TransferFlags</span> <span class="ttSigDiff">|=</span> <span class="ttSigDiff">USBD_TRANSFER_DIRECTION_IN</span> <span class="ttSigDiff">|</span> <span class="ttSigDiff">USBD_SHORT_TRANSFER_OK;</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">276</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">277</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">memcpy(&amp;urb.UrbControlTransfer.SetupPacket,&amp;pRequest-&gt;control,8);</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">278</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">279</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">status</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">call_usbd(dev,</span> <span class="ttSigDiff">&amp;urb,</span> <span class="ttSigDiff">IOCTL_INTERNAL_USB_SUBMIT_URB,</span> <span class="ttSigDiff">pRequest-&gt;timeout);</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">280</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">281</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if</span> <span class="ttSigDiff">(!NT_SUCCESS(status)</span> <span class="ttSigDiff">||</span> <span class="ttSigDiff">!USBD_SUCCESS(urb.UrbHeader.Status))</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">282</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">283</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">DEBUG_ERROR(&quot;control_transfer(): failed: status: 0x%x, urb-status: 0x%x&quot;,</span> <span class="ttSigDiff">status,</span> <span class="ttSigDiff">urb.UrbHeader.Status);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">284</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">*ret</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">0;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">285</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">286</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">else</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">287</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">288</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">*ret</span> <span class="ttSigDiff">=</span> <span class="ttSigDiff">urb.UrbControlTransfer.TransferBufferLength;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">289</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">290</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">291</td>
<td class="HasOrphan">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">return</span> <span class="ttSigDiff">status;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">292</td>
<td class="HasOrphan"><span class="ttSigDiff">}</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">293</td>
<td class="Normal">&nbsp;</td>
</tr>
</table>
</body></html>
